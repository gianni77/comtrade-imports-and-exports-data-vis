<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="style.css">

        <!--Typekit-->
        <script type="text/javascript" src="http://use.typekit.com/yfg3wnw.js"></script>
        <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
        <script src='javascript/d3.v2.js'></script>
        <script src='javascript/async.js'></script>
    </head>
    <body>
        <div id="top">&nbsp;</div>
        <div class="container">
            <article id="exports">
                <header>
                    <h1>World Commodity Trade</h1>
                </header>
                <section class="chart1">
                    <header>
                        <h2 id="India">India</h2>
                    </header>
                </section>
                <section class="chart2">
                    <header>
                        <h2 id="China">China</h2>
                    </header>
                </section>
            </article>
        </div>
        <script>
            //Data Sets
            var data1 = [60, 12, 2, 5, 40, 22];
            var data2 = [4, 8, 15, 16, 23, 42];

            //Create Charts
            var chart = d3.select(".chart1")
                          .append("div")
                          .attr("class", "bars first");        
            
            var chart2 = d3.select(".chart2")
                           .append("div")
                           .attr("class", "bars second");

            //Create scale for bars
            var width1 = d3.scale.linear()
                          .domain([0, d3.max(data1)])
                          .range (["0px", "358px"]);

            var width2 = d3.scale.linear()
                          .domain([0, d3.max(data2)])
                          .range (["0px", "358px"]);

            //Add data to charts
            chart.selectAll("div")
                  .data(data1)
                  .enter()
                  .append("div")
                  .style("width", width1)
                  .text(String);

            chart2.selectAll("div")
                  .data(data2)
                  .enter()
                  .append("div")
                  .style("width", width2)
                  .text(String);

        </script>

        <script>
        (function() {
            async.parallel([
                function fetchH3ChinaAndIndiaData(callback) {
                    d3.csv('data/h3_china_india.csv', function(rows) {
                        callback(null, rows);
                    });
                },
                function fetchCountryData(callback) {
                    d3.csv('data/country_data.csv', function(rows) {
                        callback(null, rows);
                    });
                },
                function fetchMeasurementData(callback) {
                    d3.csv('data/measurement_data.csv', function(rows) {
                        callback(null, rows);
                    });
                },
                function fetchCommodityClassificationData(callback) {
                    d3.csv('data/commodity_classification/H3.csv', function(rows) {
                        callback(null, rows);
                    });
                }
            ], function(error, results) {
                console.log(results);
            });
        })();
        </script>

    </body>
</html>
